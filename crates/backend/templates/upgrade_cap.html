{% extends "base.html" %}

{% block title %}UpgradeCap: {{ short_id }}{% endblock %}

{% block header %}
<div class="flex items-center text-3xl font-bold tracking-tight gap-4">
    <span></span>
    <span>::</span>
    <span>{{ short_id }}</span>
</div>
{% endblock %}

{% block content %}
<div class="w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-8">
    <!-- Overview Card -->
    <div class="bg-white border-[3px] border-black rounded-[2.5rem] p-10 shadow-hard flex flex-col transition-transform hover:-translate-y-1">
        <h2 class="text-3xl font-bold mb-6">Overview</h2>
        <div class="flex flex-col gap-3 text-xl">
            <div class="flex gap-2">
                <span class="font-semibold">Package:</span>
                <span>{{ package }}</span>
            </div>
            <div class="flex gap-2">
                <span class="font-semibold">Version:</span>
                <span>{{ version }}</span>
            </div>
            <div class="flex gap-2">
                <span class="font-semibold">Policy:</span>
                <span>{{ policy }}</span>
            </div>
            <div class="flex gap-2">
                <span class="font-semibold">Owner:</span>
                <span class="break-all">{{ owner }}</span>
            </div>
        </div>
    </div>

    <!-- More Info Card -->
    <div class="bg-white border-[3px] border-black rounded-[2.5rem] p-10 shadow-hard flex flex-col transition-transform hover:-translate-y-1">
        <h2 class="text-3xl font-bold mb-6">More Info</h2>
        <div class="flex flex-col gap-1 text-xl">
            <span class="font-semibold">Created By</span>
            <div class="flex gap-2 items-center">
                <span class="break-all">{{ created_by }}</span>
                <span>|</span>
                <a href="{{ tx_digest_url }}" class="hover:underline">{{ time_ago }}</a>
            </div>
        </div>
    </div>
    <!-- Tabs & Table Section -->
    <div x-data="{ tab: 'upgrades' }" class="col-span-1 md:col-span-2 flex flex-col gap-6">
        <!-- Tab Buttons -->
        <div class="flex gap-4">
            <button 
                @click="tab = 'upgrades'"
                :class="tab === 'upgrades' ? 'bg-[#5D5FEF] text-white' : 'bg-white text-black'"
                class="px-8 py-3 rounded-xl border-[3px] border-black font-bold text-xl shadow-hard transition-all active:translate-y-1"
                hx-get="/cap/{{ id }}/versions"
                hx-trigger="load, click"
                hx-target="#table-body">
                Upgrades
            </button>
            <button 
                @click="tab = 'transfers'"
                :class="tab === 'transfers' ? 'bg-[#5D5FEF] text-white' : 'bg-white text-black'"
                class="px-8 py-3 rounded-xl border-[3px] border-black font-bold text-xl shadow-hard transition-all active:translate-y-1"
                hx-get="/cap/{{ id }}/transfers"
                hx-target="#table-body">
                Transfers
            </button>
        </div>

        <!-- content Card -->
        <div class="bg-white border-[3px] border-black rounded-[2.5rem] p-8 shadow-hard min-h-[300px]">
            <div class="overflow-x-auto">
                <table class="w-full text-left text-xl border-separate border-spacing-y-4">
                    <!-- Upgrades Header -->
                    <thead x-show="tab === 'upgrades'">
                        <tr class="text-black font-bold">
                            <th class="pb-2">Version</th>
                            <th class="pb-2">Package ID</th>
                            <th class="pb-2">Tx Digest</th>
                            <th class="pb-2">Checkpoint</th>
                            <th class="pb-2">Age</th>
                        </tr>
                    </thead>
                    <!-- Transfers Header -->
                    <thead x-show="tab === 'transfers'" style="display: none;">
                        <tr class="text-black font-bold">
                            <th class="pb-2">Tx Digest</th>
                            <th class="pb-2">Checkpoint</th>
                            <th class="pb-2">Age</th>
                            <th class="pb-2">From</th>
                            <th class="pb-2">To</th>
                        </tr>
                    </thead>
                    
                    <!-- Table Body (Target for HTMX) -->
                    <tbody id="table-body" class="font-medium text-lg space-y-4">
                        <!-- Placeholder Rows (will be replaced by HTMX) -->
                        <tr class="bg-white border-[3px] border-black rounded-xl">
                            <td colspan="5" class="py-4 px-6 border-[3px] border-black rounded-xl">&nbsp;</td>
                        </tr>
                         <tr class="bg-white border-[3px] border-black rounded-xl">
                            <td colspan="5" class="py-4 px-6 border-[3px] border-black rounded-xl">&nbsp;</td>
                        </tr>
                         <tr class="bg-white border-[3px] border-black rounded-xl">
                            <td colspan="5" class="py-4 px-6 border-[3px] border-black rounded-xl">&nbsp;</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}